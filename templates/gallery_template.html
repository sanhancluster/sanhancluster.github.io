<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.4.1/css/all.css"
    integrity="sha384-5sAR7xN1Nv6T6+dT2mhtzEpVJvfS3NScPQTrOxhwjIuvcA67KV2R5Jz6kr4abQsz" crossorigin="anonymous">
    <link rel="stylesheet" href="style.css">
    <base target="_blank">
    <title>San Han</title>
    <script src="https://www.w3schools.com/lib/w3data.js"></script>
    
    <script src="https://openseadragon.github.io/openseadragon/openseadragon.min.js"></script>
</head>
<body style="margin-left: 1em">
    <header>
        <h1><a href=index.html>San Han</a>'s Simulation Gallery</h1>
    </header>
    <main>
        <h2>Images</h2>
        <hr>
        <div id="images">
            <h3>Small</h3>
            <div class="gallery">
                {list_images}
            </div>
        </div>
        <hr>
        <div id="large_images">
            <div class="gallery">
                <h3>Zoomable</h3>
                <div class="thumb-list">
                    {list_large_images}
                </div>
                <div id="osd-overlay">
                    <div id="close-btn" onclick="closeViewer()">✕</div>
                    <div id="openseadragon-viewer"></div>
                </div>
                
                <script>
                    let viewer = null;
                    
                    // click event for thumbnails
                    document.querySelectorAll('.thumb-list img').forEach(img => {
                        img.addEventListener('click', () => {
                            const dziPath = img.getAttribute('data-dzi');
                            openViewer(dziPath);
                        });
                    });
                    
                    function openViewer(dziPath) {
                        document.getElementById('osd-overlay').style.display = 'block';
                        if (viewer) {
                            viewer.open(dziPath); // 이미지 전환
                        } else {
                            viewer = OpenSeadragon({
                                id: "openseadragon-viewer",
                                prefixUrl: "https://openseadragon.github.io/openseadragon/images/",
                                tileSources: dziPath,
                                showNavigationControl: true,
                                defaultZoomLevel: 1,
                                maxZoomPixelRatio: 2,
                                minZoomLevel: 0.5,
                                springStiffness: 10.,
                                animationTime: 0.5,
                            });
                        }
                    }
                    
                    function closeViewer() {
                        if (viewer) viewer.close();
                        document.getElementById('osd-overlay').style.display = 'none';
                    }
                    
                    // close viewer on ESC key
                    document.addEventListener('keydown', e => {
                        if (e.key === 'Escape') closeViewer();
                    });
                </script>
            </div>
            
            <hr>
            
            <div id="videos">
                <h2>Videos</h2>
                <div class="gallery">
                    {list_videos}
                </div>
            </div>
        </main>
    </body> 